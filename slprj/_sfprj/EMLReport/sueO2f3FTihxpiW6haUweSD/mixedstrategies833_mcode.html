<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="155,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T19U3">X1</span>, <span class="var type1" id="S3T19U4">X2</span>, <span class="var type1" id="S4T42U5">lin</span>, <span class="var type1" id="S5T42U6">b</span>, <span class="var type1" id="S6T1U7">v</span>] = mixedstrategies( <span class="var type1" id="S7T23U10">payoff</span>, <span class="var type1" id="S8T1U11">playerNum</span> )     </span></span>
<span class="srcline"><span class="lineno"><a href="155,2" id="srcline2"> 2</a></span><span class="line">    <span class="mxinfo " id="T1:U8">[<span class="var type1" id="S9T1U15">m</span>,<span class="var type1" id="S10T1U16">n</span>] = size(<span class="var type1" id="S7T23U19">payoff</span>)</span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="155,3" id="srcline3"> 3</a></span><span class="line">    coder.extrinsic(<span class="string">'linprog'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="155,4" id="srcline4"> 4</a></span><span class="line">    coder.varsize(<span class="string">'lin'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="155,5" id="srcline5"> 5</a></span><span class="line">    coder.varsize(<span class="string">'b'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="155,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo " id="T42:U12"><span class="var type1" id="S4T42U40">lin</span> = <span class="mxinfo " id="T55:U14">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo " id="T42:U15"><span class="var type1" id="S5T42U45">b</span> = <span class="mxinfo " id="T55:U17">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo " id="T1:U18"><span class="var type1" id="S6T1U50">v</span> = <span class="mxinfo " id="T1:U20">Inf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,9" id="srcline9"> 9</a></span><span class="line">    <span class="comment">% There is a saddle point in pure strategies</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,10" id="srcline10">10</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T2:U21"><span class="mxinfo " id="T1:U22">min(<span class="mxinfo " id="T18:U23">max(<span class="var type1" id="S7T23U60">payoff</span>)</span>)</span>==<span class="mxinfo " id="T1:U25">max(<span class="mxinfo " id="T19:U26">min(<span class="var type1" id="S7T23U65">payoff</span>,[],2)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="155,11" id="srcline11">11</a></span><span class="line">        <span class="mxinfo " id="T18:U28"><span class="var type1" id="S16T18U71">maxP</span>=<span class="mxinfo " id="T18:U30">max(<span class="var type1" id="S7T23U74">payoff</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="155,12" id="srcline12">12</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S17T1U77">i</span>=<span class="mxinfo " id="T19:U33"><span class="mxinfo " id="T1:U34">1</span>:<span class="var type1" id="S9T1U80">m</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="155,13" id="srcline13">13</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S18T1U83">j</span>=<span class="mxinfo " id="T19:U37"><span class="mxinfo " id="T1:U38">1</span>:<span class="var type1" id="S10T1U86">n</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="155,14" id="srcline14">14</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T2:U40">isequal(<span class="mxinfo " id="T1:U41"><span class="var type1" id="S16T18U92">maxP</span>(<span class="var type1" id="S18T1U93">j</span>)</span>,<span class="mxinfo " id="T1:U44"><span class="var type1" id="S7T23U95">payoff</span>(<span class="var type1" id="S17T1U96">i</span>,<span class="var type1" id="S18T1U97">j</span>)</span>)</span>      </span></span>
<span class="srcline"><span class="lineno"><a href="155,15" id="srcline15">15</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T2:U48">isequal(<span class="mxinfo " id="T1:U49"><span class="var type1" id="S7T23U103">payoff</span>(<span class="var type1" id="S17T1U104">i</span>,<span class="var type1" id="S18T1U105">j</span>)</span>,<span class="mxinfo " id="T1:U53">min(<span class="mxinfo " id="T18:U54"><span class="var type1" id="S7T23U109">payoff</span>(<span class="var type1" id="S17T1U110">i</span>,<span class="mxinfo " id="T79:U57">:</span>)</span>)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,16" id="srcline16">16</a></span><span class="line">                        min(<span class="mxinfo " id="T18:U58"><span class="var type1" id="S7T23U116">payoff</span>(<span class="var type1" id="S17T1U117">i</span>,<span class="mxinfo " id="T79:U61">:</span>)</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="155,17" id="srcline17">17</a></span><span class="line">                        <span class="mxinfo " id="T1:U62"><span class="var type1" id="S20T1U121">r</span> = <span class="var type1" id="S17T1U122">i</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,18" id="srcline18">18</a></span><span class="line">                        <span class="mxinfo " id="T1:U65"><span class="var type1" id="S21T1U125">s</span> = <span class="var type1" id="S18T1U126">j</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,19" id="srcline19">19</a></span><span class="line">                        <span class="mxinfo " id="T1:U68"><span class="var type1" id="S6T1U129">v</span> = <span class="mxinfo " id="T1:U70"><span class="var type1" id="S7T23U131">payoff</span>(<span class="var type1" id="S20T1U132">r</span>,<span class="var type1" id="S21T1U133">s</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,20" id="srcline20">20</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,21" id="srcline21">21</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,22" id="srcline22">22</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,23" id="srcline23">23</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,24" id="srcline24">24</a></span><span class="line">        <span class="mxinfo " id="T19:U74"><span class="var type1" id="S2T19U136">X1</span> = <span class="mxinfo " id="T19:U76">zeros(<span class="mxinfo " id="T1:U77"><span class="var type1" id="S9T1U139">m</span></span>,1)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="155,25" id="srcline25">25</a></span><span class="line">        <span class="mxinfo " id="T19:U79"><span class="var type1" id="S3T19U143">X2</span> = <span class="mxinfo " id="T19:U81">zeros(<span class="mxinfo " id="T1:U82"><span class="var type1" id="S9T1U146">m</span></span>,1)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="155,26" id="srcline26">26</a></span><span class="line">        <span class="keyword">if</span> <span class="var type1" id="S8T1U151">playerNum</span> == 1</span></span>
<span class="srcline"><span class="lineno"><a href="155,27" id="srcline27">27</a></span><span class="line">            <span class="var type0" id="S2T0U156">X1</span>(<span class="var type0" id="S20T0U157">r</span>) = 1.0;</span></span>
<span class="srcline"><span class="lineno"><a href="155,28" id="srcline28">28</a></span><span class="line">            <span class="var type0" id="S3T0U162">X2</span>(<span class="var type0" id="S21T0U163">s</span>) = 1.0;</span></span>
<span class="srcline"><span class="lineno"><a href="155,29" id="srcline29">29</a></span><span class="line">        <span class="keyword">elseif</span> <span class="var type1" id="S8T1U167">playerNum</span> == 2</span></span>
<span class="srcline"><span class="lineno"><a href="155,30" id="srcline30">30</a></span><span class="line">            <span class="mxinfo " id="T1:U86"><span class="mxinfo " id="T1:U87"><span class="var type1" id="S3T19U172">X2</span>(<span class="var type1" id="S20T1U173">r</span>)</span> = <span class="mxinfo " id="T1:U90">1.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,31" id="srcline31">31</a></span><span class="line">            <span class="mxinfo " id="T1:U91"><span class="mxinfo " id="T1:U92"><span class="var type1" id="S2T19U178">X1</span>(<span class="var type1" id="S21T1U179">s</span>)</span> = <span class="mxinfo " id="T1:U95">1.0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,32" id="srcline32">32</a></span><span class="line">        <span class="keyword">end</span>       </span></span>
<span class="srcline"><span class="lineno"><a href="155,33" id="srcline33">33</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="155,34" id="srcline34">34</a></span><span class="line">    <span class="comment">% There is no saddle point in pure strategies, so extend to mixed</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,35" id="srcline35">35</a></span><span class="line">    <span class="comment">% strategies by solving linear system of equations Ax = b by linear</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,36" id="srcline36">36</a></span><span class="line">    <span class="comment">% programming</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,37" id="srcline37">37</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,38" id="srcline38">38</a></span><span class="line">        <span class="comment">% add last equation x1 + x2 + <span class="keyword">...</span><span class="comment"> xm = 1, probabilities must sum up</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="155,39" id="srcline39">39</a></span><span class="line">        <span class="comment">% to 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,40" id="srcline40">40</a></span><span class="line">        <span class="mxinfo " id="T46:U96"><span class="mxinfo " id="T46:U97"><span class="var type1" id="S4T42U185">lin</span>(<span class="mxinfo " id="T1:U99"><span class="var type1" id="S9T1U186">m</span></span>,<span class="mxinfo " id="T60:U101">:</span>)</span> = <span class="mxinfo " id="T18:U102">ones(<span class="mxinfo " id="T1:U103">1</span>,<span class="mxinfo " id="T1:U104"><span class="var type1" id="S9T1U191">m</span></span>)</span></span>       </span></span>
<span class="srcline"><span class="lineno"><a href="155,41" id="srcline41">41</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="155,42" id="srcline42">42</a></span><span class="line">        <span class="mxinfo " id="T80:U106"><span class="var type1" id="S24T80U194">f</span> = <span class="mxinfo " id="T80:U108">[<span class="mxinfo " id="T19:U109">zeros(<span class="mxinfo " id="T1:U110"><span class="var type1" id="S9T1U199">m</span></span>,1)</span>; <span class="mxinfo " id="T1:U112">-<span class="mxinfo " id="T1:U113">1</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,43" id="srcline43">43</a></span><span class="line">        <span class="mxinfo " id="T80:U114"><span class="var type1" id="S25T80U206">lb</span> = <span class="mxinfo " id="T80:U116">[<span class="mxinfo " id="T19:U117">zeros(<span class="mxinfo " id="T1:U118"><span class="var type1" id="S9T1U211">m</span></span>,1)</span> ;<span class="mxinfo " id="T1:U120">-<span class="mxinfo " id="T1:U121">Inf</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,44" id="srcline44">44</a></span><span class="line">        <span class="mxinfo " id="T81:U122"><span class="var type1" id="S26T81U219">A</span> = <span class="mxinfo " id="T81:U124">[<span class="var type1" id="S7T23U222">payoff</span> <span class="mxinfo " id="T19:U126">ones(<span class="mxinfo " id="T1:U127"><span class="var type1" id="S9T1U225">m</span></span>,1)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,45" id="srcline45">45</a></span><span class="line">        <span class="comment">%A(:,m+1) = ones(m,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,46" id="srcline46">46</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="155,47" id="srcline47">47</a></span><span class="line">        <span class="mxinfo " id="T82:U129"><span class="var type1" id="S27T82U229">Aeq</span> = <span class="mxinfo " id="T82:U131">[<span class="mxinfo " id="T18:U132">ones(<span class="mxinfo " id="T1:U133">1</span>,<span class="mxinfo " id="T1:U134"><span class="var type1" id="S9T1U235">m</span></span>)</span> <span class="mxinfo " id="T1:U136">0</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,48" id="srcline48">48</a></span><span class="line">        <span class="mxinfo " id="T1:U137"><span class="var type1" id="S28T1U239">beq</span> = <span class="mxinfo " id="T1:U139">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,49" id="srcline49">49</a></span><span class="line">        <span class="mxinfo " id="T42:U140"><span class="var type1" id="S5T42U243">b</span> = <span class="mxinfo " id="T19:U142">zeros(<span class="mxinfo " id="T1:U143"><span class="var type1" id="S9T1U246">m</span></span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,50" id="srcline50">50</a></span><span class="line">        coder.varsize(<span class="mxinfo " id="T15:U145"><span class="string"><span class="message error" id="M21F833C">'X1'</span></span></span>);</span></span>
<span class="srcline"><span class="lineno"><a href="155,51" id="srcline51">51</a></span><span class="line">        <span class="mxinfo " id="T19:U146"><span class="var type1" id="S2T19U256"><span class="message error" id="M22F833C">X1</span></span></span> = <span class="mxinfo " id="T18:U147">zeros(<span class="mxinfo " id="T1:U148">1</span>,<span class="mxinfo " id="T1:U149">size(<span class="var type1" id="S7T23U262">payoff</span>,1)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,52" id="srcline52">52</a></span><span class="line">        <span class="mxinfo " id="T19:U151"><span class="var type1" id="S2T19U266">X1</span> = <span class="mxinfo " id="T43:U153"><span class="extrinsicFcn" id="F834N19:B268">linprog</span>(<span class="var type1" id="S24T80U269">f</span>,<span class="var type1" id="S26T81U270">A</span>,<span class="var type1" id="S5T42U271">b</span>,<span class="var type1" id="S27T82U272">Aeq</span>,<span class="var type1" id="S28T1U273">beq</span>,<span class="var type1" id="S25T80U274">lb</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,53" id="srcline53">53</a></span><span class="line">        <span class="mxinfo " id="T1:U160"><span class="var type1" id="S6T1U277">v</span> = <span class="mxinfo " id="T1:U162">abs(<span class="mxinfo " id="T1:U163"><span class="var type1" id="S2T19U281">X1</span>(<span class="mxinfo " id="T7:U165">end</span>,<span class="mxinfo " id="T7:U166">1</span>)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="155,54" id="srcline54">54</a></span><span class="line">        <span class="mxinfo " id="T83:U167"><span class="mxinfo " id="T19:U168"><span class="var type1" id="S2T19U288"><span class="message error" id="M23F833C">X1</span></span></span>(end,:) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,55" id="srcline55">55</a></span><span class="line">        <span class="mxinfo " id="T19:U169"><span class="var type1" id="S3T19U296"><span class="message error" id="M24F833C">X2</span></span></span> = <span class="mxinfo " id="T55:U170">[]</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="155,56" id="srcline56">56</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,57" id="srcline57">57</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="155,58" id="srcline58">58</a></span><span class="line"></span></span>
</pre>
