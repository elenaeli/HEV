<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">engineTorque</span>,<span class="var type1" id="S3T1U4">motorTorque</span>] = gameTheory(<span class="var type0" id="S4T0U7">requiredTorque</span>, <span class="var type1" id="S5T23U8">FuelConsTable</span>, <span class="var type1" id="S6T26U9">GasEmisTable</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line">coder.extrinsic(<span class="string">'genpath'</span>); </span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line">coder.extrinsic(<span class="string">'addpath'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line">coder.extrinsic(<span class="string">'mat2cell'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T1:U5"><span class="var type1" id="S3T1U30">motorTorque</span> = <span class="mxinfo " id="T1:U7">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T1:U8"><span class="var type1" id="S2T1U34">engineTorque</span> = <span class="mxinfo " id="T1:U10">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T49:U11"><span class="extrinsicFcn" id="F3N2:B38">addpath</span>(<span class="mxinfo " id="T49:U12"><span class="extrinsicFcn" id="F2N7:B40">genpath</span>(<span class="mxinfo " id="T50:U13"><span class="string">'C:\Users\Elena\Documents\MATLAB\HEV\src\fuel and emissions'</span></span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="comment">%FuelConsTable = fuel;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="comment">%GasEmisTable = exhaustEmis;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="comment">%requiredTorque = 189;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T1:U14"><span class="var type1" id="S10T1U44">engineSpeedRadPerS</span> = <span class="mxinfo " id="T1:U16">500</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T1:U17"><span class="var type1" id="S11T1U48">engineSpeedRadRPM</span> = <span class="mxinfo " id="T1:U19"><span class="var type1" id="S10T1U50">engineSpeedRadPerS</span>*9.5492</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T1:U21"><span class="var type1" id="S12T1U54">SOC_deviation</span> = <span class="mxinfo " id="T1:U23">0.05</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T1:U24"><span class="var type1" id="S13T1U58">maxEngineTorque</span> = <span class="mxinfo " id="T1:U26">136</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T1:U27"><span class="var type1" id="S14T1U62">maxMotorTorque</span> = <span class="mxinfo " id="T1:U29">400</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T1:U30"><span class="var type1" id="S15T1U66">maxRPM</span> = <span class="mxinfo " id="T1:U32">6000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T1:U33"><span class="var type1" id="S16T1U70">M</span> = <span class="mxinfo " id="T1:U35">10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T1:U36"><span class="var type1" id="S17T1U74">N</span> = <span class="mxinfo " id="T1:U38">10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T22:U39"><span class="var type1" id="S18T22U78">payoffMotor</span> = <span class="mxinfo " id="T22:U41">zeros(<span class="mxinfo " id="T1:U42"><span class="var type1" id="S16T1U82">M</span>+1</span>,<span class="mxinfo " id="T1:U44"><span class="var type1" id="S17T1U85">N</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T22:U46"><span class="var type1" id="S20T22U89">payoffEngine</span> = <span class="mxinfo " id="T22:U48">zeros(<span class="mxinfo " id="T1:U49"><span class="var type1" id="S16T1U93">M</span>+1</span>,<span class="mxinfo " id="T1:U51"><span class="var type1" id="S17T1U96">N</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T11:U53"><span class="var type1" id="S21T11U100">percentage</span> = <span class="mxinfo " id="T11:U55">0:(1/<span class="var type1" id="S16T1U107">M</span>):1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T1:U57"><span class="var type1" id="S22T1U111">maxMotorTorqueStrategy</span> = <span class="mxinfo " id="T1:U59">min(<span class="mxinfo " id="T14:U60">[<span class="var type1" id="S4T1U116">requiredTorque</span> <span class="mxinfo " id="T1:U62"><span class="var type1" id="S14T1U117">maxMotorTorque</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo " id="T1:U64"><span class="var type1" id="S24T1U120">maxEngineTorqueStrategy</span> = <span class="mxinfo " id="T1:U66">min(<span class="mxinfo " id="T14:U67">[<span class="var type1" id="S4T1U125">requiredTorque</span> <span class="mxinfo " id="T1:U69"><span class="var type1" id="S13T1U126">maxEngineTorque</span></span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo " id="T11:U71"><span class="var type1" id="S25T11U129">strategyEng</span> = <span class="mxinfo " id="T11:U73"><span class="var type1" id="S21T11U131">percentage</span> .* <span class="var type1" id="S24T1U132">maxEngineTorqueStrategy</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo " id="T11:U76"><span class="var type1" id="S26T11U135">strategyMot</span> = <span class="mxinfo " id="T11:U78"><span class="var type1" id="S21T11U137">percentage</span> .* <span class="var type1" id="S22T1U138">maxMotorTorqueStrategy</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"><span class="comment">%strategyMot = fliplr(strategyMot);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo " id="T22:U81"><span class="var type1" id="S27T22U141">tmpTorque</span> = <span class="mxinfo " id="T22:U83">repmat(<span class="mxinfo " id="T18:U84"><span class="var type1" id="S25T11U145">strategyEng</span>'</span>,1,<span class="var type1" id="S16T1U148">M</span>+1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T24:U87"><span class="var type1" id="S29T24U152">tmpS</span> = <span class="mxinfo " id="T24:U89">abs(<span class="var type1" id="S5T23U157">FuelConsTable</span>.speed - <span class="var type1" id="S11T1U159">engineSpeedRadRPM</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T1:U92"><span class="var type1" id="S31T1U162">idxS</span> = <span class="mxinfo " id="T1:U94">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line">[<span class="mxinfo " id="T1:U95"><span class="mxinfo " id="T1:U96">~</span></span>, <span class="var type1" id="S31T1U168">idxS</span> ] = min(<span class="var type1" id="S29T24U171">tmpS</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo " id="T22:U99"><span class="var type1" id="S32T22U174">totalTorque</span> = <span class="mxinfo " id="T22:U101">zeros(<span class="mxinfo " id="T1:U102"><span class="var type1" id="S16T1U178">M</span>+1</span>, <span class="mxinfo " id="T1:U104"><span class="var type1" id="S17T1U181">N</span>+1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S33T1U185">i</span> = <span class="mxinfo " id="T18:U107"><span class="mxinfo " id="T1:U108">1</span>:<span class="var type1" id="S16T1U189">M</span>+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S34T1U193">j</span> = <span class="mxinfo " id="T18:U111"><span class="mxinfo " id="T1:U112">1</span>:<span class="var type1" id="S17T1U197">N</span>+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line">        <span class="mxinfo " id="T1:U114"><span class="mxinfo " id="T1:U115"><span class="var type1" id="S32T22U202">totalTorque</span>(<span class="var type1" id="S33T1U203">i</span>,<span class="var type1" id="S34T1U204">j</span>)</span> = <span class="mxinfo " id="T1:U119"><span class="mxinfo " id="T1:U120"><span class="var type1" id="S27T22U207">tmpTorque</span>(<span class="var type1" id="S33T1U208">i</span>,<span class="var type1" id="S34T1U209">j</span>)</span> + <span class="mxinfo " id="T1:U124"><span class="var type1" id="S26T11U211">strategyMot</span>(<span class="var type1" id="S34T1U212">j</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">45</a></span><span class="line"><span class="comment">%T = P * 9.549 / n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46">46</a></span><span class="line"><span class="mxinfo " id="T1:U127"><span class="var type1" id="S35T1U215">engineMaxPower</span> = <span class="mxinfo " id="T1:U129">57000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47">47</a></span><span class="line"><span class="mxinfo " id="T1:U130"><span class="var type1" id="S36T1U219">motorMaxPower</span> = <span class="mxinfo " id="T1:U132">50000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48">48</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49">49</a></span><span class="line"><span class="mxinfo " id="T47:U133"><span class="var type1" id="S37T47U223">motorSpeed</span> = <span class="mxinfo " id="T47:U135">[<span class="mxinfo " id="T1:U136">0</span>, <span class="mxinfo " id="T1:U137">1200</span>, <span class="mxinfo " id="T1:U138">2000</span>, <span class="mxinfo " id="T1:U139">3000</span>, <span class="mxinfo " id="T1:U140">4000</span>, <span class="mxinfo " id="T1:U141">5000</span>, <span class="mxinfo " id="T1:U142">6000</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50">50</a></span><span class="line"><span class="mxinfo " id="T47:U143"><span class="var type1" id="S38T47U235">motorTorqueRef</span> = <span class="mxinfo " id="T47:U145">[<span class="mxinfo " id="T1:U146">400</span>, <span class="mxinfo " id="T1:U147">400</span>, <span class="mxinfo " id="T1:U148">280</span>, <span class="mxinfo " id="T1:U149">222</span>, <span class="mxinfo " id="T1:U150">179</span>, <span class="mxinfo " id="T1:U151">143</span>, <span class="mxinfo " id="T1:U152">119</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51">51</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52">52</a></span><span class="line"><span class="mxinfo " id="T48:U153"><span class="var type1" id="S39T48U247">engineSpeed</span> = <span class="mxinfo " id="T48:U155">[<span class="mxinfo " id="T1:U156">0</span>, <span class="mxinfo " id="T1:U157">420</span>, <span class="mxinfo " id="T1:U158">900</span>, <span class="mxinfo " id="T1:U159">1380</span>, <span class="mxinfo " id="T1:U160">1860</span>, <span class="mxinfo " id="T1:U161">2340</span>, <span class="mxinfo " id="T1:U162">2820</span>, <span class="mxinfo " id="T1:U163">3300</span>, <span class="mxinfo " id="T1:U164">3780</span>, <span class="mxinfo " id="T1:U165">4260</span>, <span class="mxinfo " id="T1:U166">4740</span>, <span class="mxinfo " id="T1:U167">5220</span>, <span class="mxinfo " id="T1:U168">5700</span>, <span class="mxinfo " id="T1:U169">6000</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53">53</a></span><span class="line"><span class="mxinfo " id="T48:U170"><span class="var type1" id="S40T48U266">engineTorqueRef</span> = <span class="mxinfo " id="T48:U172">[<span class="mxinfo " id="T1:U173">109</span>, <span class="mxinfo " id="T1:U174">117</span>, <span class="mxinfo " id="T1:U175">125</span>, <span class="mxinfo " id="T1:U176">131</span>, <span class="mxinfo " id="T1:U177">134</span>, <span class="mxinfo " id="T1:U178">136</span>, <span class="mxinfo " id="T1:U179">136</span>, <span class="mxinfo " id="T1:U180">133</span>, <span class="mxinfo " id="T1:U181">129</span>, <span class="mxinfo " id="T1:U182">123</span>, <span class="mxinfo " id="T1:U183">114</span>, <span class="mxinfo " id="T1:U184">104</span>, <span class="mxinfo " id="T1:U185">91</span>, <span class="mxinfo " id="T1:U186">83</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54">54</a></span><span class="line"><span class="mxinfo " id="T1:U187"><span class="var type1" id="S41T1U285">wFuel</span> = <span class="mxinfo " id="T1:U189">60</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55">55</a></span><span class="line"><span class="mxinfo " id="T1:U190"><span class="var type1" id="S42T1U289">wPower</span> = <span class="mxinfo " id="T1:U192">0.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56">56</a></span><span class="line"><span class="mxinfo " id="T1:U193"><span class="var type1" id="S43T1U293">wDrDem</span> = <span class="mxinfo " id="T1:U195">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57">57</a></span><span class="line"><span class="mxinfo " id="T1:U196"><span class="var type1" id="S44T1U297">wSOC</span> = <span class="mxinfo " id="T1:U198">21</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58">58</a></span><span class="line"><span class="mxinfo " id="T1:U199"><span class="var type1" id="S45T1U301">wNOX</span> = <span class="mxinfo " id="T1:U201">28</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59">59</a></span><span class="line"><span class="mxinfo " id="T1:U202"><span class="var type1" id="S46T1U305">wCO</span> = <span class="mxinfo " id="T1:U204">56</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60">60</a></span><span class="line"><span class="mxinfo " id="T1:U205"><span class="var type1" id="S47T1U309">wHC</span> = <span class="mxinfo " id="T1:U207">45</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61">61</a></span><span class="line"><span class="comment">%fuelConsumedGPS = zeros(1,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62">62</a></span><span class="line"><span class="comment">%powerKW = zeros(1,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63">63</a></span><span class="line"><span class="comment">%HCEmissions = zeros(1,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64">64</a></span><span class="line"><span class="comment">%COEmissions = zeros(1,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65">65</a></span><span class="line"><span class="comment">%NOXEmissions = zeros(1,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66">66</a></span><span class="line">size(<span class="var type1" id="S4T1U314">requiredTorque</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67">67</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S33T1U317">i</span> = <span class="mxinfo " id="T18:U210"><span class="mxinfo " id="T1:U211">1</span>:<span class="var type1" id="S16T1U321">M</span>+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68">68</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S34T1U325">j</span> = <span class="mxinfo " id="T18:U214"><span class="mxinfo " id="T1:U215">1</span>:<span class="var type1" id="S17T1U329">N</span>+1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69">69</a></span><span class="line">        <span class="mxinfo " id="T24:U217"><span class="var type1" id="S49T24U333">tmpT</span> = <span class="mxinfo " id="T24:U219">abs(<span class="mxinfo " id="T24:U220"><span class="mxinfo " id="T24:U221"><span class="mxinfo " id="T23:U222"><span class="var type1" id="S5T23U338">FuelConsTable</span></span>.torque</span> - <span class="mxinfo " id="T1:U224"><span class="var type1" id="S25T11U341">strategyEng</span>(<span class="var type1" id="S34T1U342">j</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70">70</a></span><span class="line">        <span class="mxinfo " id="T1:U227"><span class="var type1" id="S50T1U345">idxT</span> = <span class="mxinfo " id="T1:U229">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71">71</a></span><span class="line">        [<span class="mxinfo " id="T1:U230"><span class="mxinfo " id="T1:U231">~</span></span>, <span class="mxinfo " id="T1:U232"><span class="var type1" id="S50T1U351">idxT</span></span>] = min(<span class="var type1" id="S49T24U354">tmpT</span>);      </span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72">72</a></span><span class="line">        <span class="mxinfo " id="T1:U235"><span class="var type1" id="S51T1U357">fuelConsumedGPS</span> = <span class="mxinfo " id="T1:U237"><span class="mxinfo " id="T25:U238"><span class="mxinfo " id="T23:U239"><span class="var type1" id="S5T23U360">FuelConsTable</span></span>.lookupTableFuel</span>(<span class="var type1" id="S50T1U362">idxT</span>, <span class="mxinfo " id="T7:U242"><span class="var type1" id="S31T7U363">idxS</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73">73</a></span><span class="line">        <span class="mxinfo " id="T1:U244"><span class="var type1" id="S52T1U366">powerKW</span> = <span class="mxinfo " id="T1:U246"><span class="mxinfo " id="T25:U247"><span class="mxinfo " id="T23:U248"><span class="var type1" id="S5T23U369">FuelConsTable</span></span>.lookupTablePower</span>(<span class="var type1" id="S50T1U371">idxT</span>, <span class="mxinfo " id="T7:U251"><span class="var type1" id="S31T7U372">idxS</span></span>)</span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74">74</a></span><span class="line">        <span class="mxinfo " id="T1:U253"><span class="var type1" id="S53T1U375">HCEmissions</span> = <span class="mxinfo " id="T1:U255"><span class="mxinfo " id="T25:U256"><span class="mxinfo " id="T26:U257"><span class="var type1" id="S6T26U378">GasEmisTable</span></span>.lookupTableHC</span>(<span class="var type1" id="S50T1U380">idxT</span>, <span class="mxinfo " id="T7:U260"><span class="var type1" id="S31T7U381">idxS</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75">75</a></span><span class="line">        <span class="mxinfo " id="T1:U262"><span class="var type1" id="S54T1U384">COEmissions</span> = <span class="mxinfo " id="T1:U264"><span class="mxinfo " id="T25:U265"><span class="mxinfo " id="T26:U266"><span class="var type1" id="S6T26U387">GasEmisTable</span></span>.lookupTableCO</span>(<span class="var type1" id="S50T1U389">idxT</span>, <span class="mxinfo " id="T7:U269"><span class="var type1" id="S31T7U390">idxS</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76">76</a></span><span class="line">        <span class="mxinfo " id="T1:U271"><span class="var type1" id="S55T1U393">NOXEmissions</span> = <span class="mxinfo " id="T1:U273"><span class="mxinfo " id="T25:U274"><span class="mxinfo " id="T26:U275"><span class="var type1" id="S6T26U396">GasEmisTable</span></span>.lookupTableNOX</span>(<span class="var type1" id="S50T1U398">idxT</span>, <span class="mxinfo " id="T7:U278"><span class="var type1" id="S31T7U399">idxS</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77">77</a></span><span class="line">        <span class="mxinfo " id="T1:U280"><span class="mxinfo " id="T1:U281"><span class="var type1" id="S20T22U403">payoffEngine</span>(<span class="var type1" id="S33T1U404">i</span>,<span class="var type1" id="S34T1U405">j</span>)</span> = <span class="mxinfo " id="T1:U285"><span class="mxinfo " id="T1:U286"><span class="mxinfo " id="T1:U287"><span class="mxinfo " id="T1:U288"><span class="mxinfo " id="T1:U289"><span class="mxinfo " id="T1:U290"><span class="mxinfo " id="T1:U291"><span class="var type1" id="S41T1U412">wFuel</span></span>*<span class="var type1" id="S51T1U413">fuelConsumedGPS</span></span> + <span class="mxinfo " id="T1:U294"><span class="mxinfo " id="T1:U295"><span class="var type1" id="S43T1U415">wDrDem</span></span>*<span class="mxinfo " id="T1:U297">abs(<span class="mxinfo " id="T1:U298"><span class="var type1" id="S4T1U419">requiredTorque</span> - <span class="mxinfo " id="T1:U300"><span class="var type1" id="S32T22U421">totalTorque</span>(<span class="var type1" id="S33T1U422">i</span>,<span class="var type1" id="S34T1U423">j</span>)</span></span>)</span></span></span> + <span class="mxinfo " id="T1:U304"><span class="mxinfo " id="T1:U305"><span class="var type1" id="S44T1U425">wSOC</span></span>*<span class="mxinfo " id="T1:U307"><span class="var type1" id="S12T1U426">SOC_deviation</span></span></span></span> + <span class="mxinfo " id="T1:U309"><span class="mxinfo " id="T1:U310"><span class="var type1" id="S47T1U428">wHC</span></span>*<span class="var type1" id="S53T1U429">HCEmissions</span></span></span> + <span class="mxinfo " id="T1:U313"><span class="mxinfo " id="T1:U314"><span class="var type1" id="S46T1U431">wCO</span></span>*<span class="var type1" id="S54T1U432">COEmissions</span></span></span> + <span class="mxinfo " id="T1:U317"><span class="mxinfo " id="T1:U318"><span class="var type1" id="S45T1U434">wNOX</span></span>*<span class="var type1" id="S55T1U435">NOXEmissions</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78">78</a></span><span class="line">        <span class="mxinfo " id="T1:U321"><span class="mxinfo " id="T1:U322"><span class="var type1" id="S18T22U439">payoffMotor</span>(<span class="var type1" id="S33T1U440">i</span>,<span class="var type1" id="S34T1U441">j</span>)</span> = <span class="mxinfo " id="T1:U326"><span class="mxinfo " id="T1:U327"><span class="mxinfo " id="T1:U328"><span class="mxinfo " id="T1:U329"><span class="mxinfo " id="T1:U330"><span class="mxinfo " id="T1:U331"><span class="mxinfo " id="T1:U332"><span class="var type1" id="S42T1U448">wPower</span></span>*<span class="var type1" id="S52T1U449">powerKW</span></span> + <span class="mxinfo " id="T1:U335"><span class="mxinfo " id="T1:U336"><span class="var type1" id="S43T1U451">wDrDem</span></span>*<span class="mxinfo " id="T1:U338">abs(<span class="mxinfo " id="T1:U339"><span class="var type1" id="S4T1U455">requiredTorque</span> - <span class="mxinfo " id="T1:U341"><span class="var type1" id="S32T22U457">totalTorque</span>(<span class="var type1" id="S33T1U458">i</span>,<span class="var type1" id="S34T1U459">j</span>)</span></span>)</span></span></span> + <span class="mxinfo " id="T1:U345"><span class="mxinfo " id="T1:U346"><span class="var type1" id="S44T1U461">wSOC</span></span>*<span class="mxinfo " id="T1:U348"><span class="var type1" id="S12T1U462">SOC_deviation</span></span></span></span> + <span class="mxinfo " id="T1:U350"><span class="mxinfo " id="T1:U351"><span class="var type1" id="S47T1U464">wHC</span></span>*<span class="var type1" id="S53T1U465">HCEmissions</span></span></span> + <span class="mxinfo " id="T1:U354"><span class="mxinfo " id="T1:U355"><span class="var type1" id="S46T1U467">wCO</span></span>*<span class="var type1" id="S54T1U468">COEmissions</span></span></span> + <span class="mxinfo " id="T1:U358"><span class="mxinfo " id="T1:U359"><span class="var type1" id="S45T1U470">wNOX</span></span>*<span class="var type1" id="S55T1U471">NOXEmissions</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79">79</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80">80</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81">81</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82">82</a></span><span class="line"><span class="mxinfo " id="T28:U362"><span class="var type1" id="S56T28U474">payoffBoth</span> = <span class="mxinfo " id="T28:U364">reshape(<span class="mxinfo " id="T27:U365">[<span class="var type1" id="S18T22U479">payoffMotor</span>;<span class="var type1" id="S20T22U481">payoffEngine</span>]</span>,size(<span class="var type1" id="S18T22U484">payoffMotor</span>,1),[])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83">83</a></span><span class="line"><span class="mxinfo " id="T28:U369"><span class="var type1" id="S58T28U490">p</span> = <span class="mxinfo " id="T28:U371">zeros(<span class="mxinfo " id="T1:U372"><span class="var type1" id="S16T1U494">M</span>+1</span>, <span class="mxinfo " id="T1:U374">(<span class="var type1" id="S17T1U499">N</span>+1)*2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84">84</a></span><span class="line"><span class="comment">%payoff = mat2cell(payoffBoth, ones(1,M+1), ones(1,M+1).*2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85">85</a></span><span class="line"><span class="mxinfo " id="T28:U376"><span class="var type1" id="S58T28U504">p</span> = <span class="var type1" id="S56T28U505">payoffBoth</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86">86</a></span><span class="line"><span class="mxinfo " id="T46:U379"><span class="var type1" id="S59T46U508">pareto</span> = <span class="mxinfo " id="T46:U381">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87">87</a></span><span class="line"><span class="var type0" id="S59T0U513">pareto</span> = <span class="message error" id="M1F1C"><span class="fcn" id="F141N10:B515">paretoSet</span>(<span class="var type1" id="S58T28U516">p</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88">88</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89">89</a></span><span class="line"><span class="var type0" id="S59T0U518"><span class="message error" id="M2F1C">pareto</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90">90</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91">91</a></span><span class="line"><span class="comment">%motorTorque = strategyMot(pareto(1))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92">92</a></span><span class="line"><span class="comment">%engineTorque = strategyEng(pareto(2))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93">93</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
